%%% The main file. It contains definitions of basic parameters and includes all other parts.

%% Settings for single-side (simplex) printing
% Margins: left 40mm, right 25mm, top and bottom 25mm
% (but beware, LaTeX adds 1in implicitly)
\documentclass[12pt,a4paper]{report}
\setlength\textwidth{145mm}
\setlength\textheight{247mm}
\setlength\oddsidemargin{15mm}
\setlength\evensidemargin{15mm}
\setlength\topmargin{0mm}
\setlength\headsep{0mm}
\setlength\headheight{0mm}
% \openright makes the following text appear on a right-hand page
\let\openright=\clearpage

%% Settings for two-sided (duplex) printing
% \documentclass[12pt,a4paper,twoside,openright]{report}
% \setlength\textwidth{145mm}
% \setlength\textheight{247mm}
% \setlength\oddsidemargin{14.2mm}
% \setlength\evensidemargin{0mm}
% \setlength\topmargin{0mm}
% \setlength\headsep{0mm}
% \setlength\headheight{0mm}
% \let\openright=\cleardoublepage

%% Generate PDF/A-2u
\usepackage[a-2u]{pdfx}

%% Character encoding: usually latin2, cp1250 or utf8:
\usepackage[utf8]{inputenc}

%% Prefer Latin Modern fonts
\usepackage{lmodern}

%% Further useful packages (included in most LaTeX distributions)
\usepackage{amsmath}        % extensions for typesetting of math
\usepackage{amsfonts}       % math fonts
\usepackage{amsthm}         % theorems, definitions, etc.
\usepackage{bbding}         % various symbols (squares, asterisks, scissors, ...)
\usepackage{bm}             % boldface symbols (\bm)
\usepackage{graphicx}       % embedding of pictures
\usepackage{fancyvrb}       % improved verbatim environment
\usepackage[numbers]{natbib}         % citation style AUTHOR (YEAR), or AUTHOR [NUMBER]

%%% !!! Citation style is overriden to just a [NUMBER] !!!

\usepackage[nottoc]{tocbibind} % makes sure that bibliography and the lists
			    % of figures/tables are included in the table
			    % of contents
\usepackage{dcolumn}        % improved alignment of table columns
\usepackage{booktabs}       % improved horizontal lines in tables
\usepackage{paralist}       % improved enumerate and itemize
\usepackage{xcolor}         % typesetting in color

%% Path to images
\graphicspath{ {../img/} }

%%% Basic information on the thesis

% Thesis title in English (exactly as in the formal assignment)
\def\ThesisTitle{Automated Program Minimization With Preserving of Runtime Errors}

% Author of the thesis
\def\ThesisAuthor{Denis Leskovar}

% Year when the thesis is submitted
\def\YearSubmitted{2021}

% Name of the department or institute, where the work was officially assigned
% (according to the Organizational Structure of MFF UK in English,
% or a full name of a department outside MFF)
\def\Department{Department of Distributed and Dependable Systems}

% Is it a department (katedra), or an institute (ústav)?
\def\DeptType{Department}

% Thesis supervisor: name, surname and titles
\def\Supervisor{doc. RNDr. Pavel Parízek, Ph.D.}

% Supervisor's department (again according to Organizational structure of MFF)
\def\SupervisorsDepartment{Department of Distributed and Dependable Systems}

% Study programme and specialization
\def\StudyProgramme{Computer Science}
\def\StudyBranch{System Programming}

% An optional dedication: you can thank whomever you wish (your supervisor,
% consultant, a person who lent the software, etc.)
\def\Dedication{%
Dedication.
}

% Abstract (recommended length around 80-200 words; this is not a copy of your thesis assignment!)
\def\Abstract{%
Debugging~of large programs is a~difficult and time consuming task.
Given~a runtime error, the~developer must first reproduce it. 
He then has~to find the cause~of the~error and create a~bugfix.
This process can be made significantly more efficient by reducing 
the amount~of code the developer has~to look into. 
This paper introduces three different methodologies~of automatically reducing
a~given program $\mathcal{P}$ into its minimal runnable subset $\mathcal{P'}$.
The automatically generated program $\mathcal{P'}$ also has~to 
result~in the~same runtime error as~$\mathcal{P}$.
The main focus~of the reduction is on~correctness when operating in a~concrete
application domain set by this study.
Implementations~of introduced methodologies written using the~LLVM compiler
infrastructure are then compared and classified.
Performance is measured based~on the statement count~of the~newly generated
program and the~speed at which the~minimal variant was generated.
Moreover, the~limits of the~three different approaches are investigated
with respect~to~the general application domain.
The~paper concludes with an~overview~of the~most general and efficient 
methodology.
}

% 3 to 5 keywords (recommended), each enclosed in curly braces
\def\Keywords{%
{automated debugging}, {code analysis}, {syntax tree}, {statement reduction}, {clang}
}

%% The hyperref package for clickable links in PDF and also for storing
%% metadata to PDF (including the table of contents).
%% Most settings are pre-set by the pdfx package.
\hypersetup{unicode}
\hypersetup{breaklinks=true}

% Definitions of macros (see description inside)
\include{macros}

% Title page and various mandatory informational pages
\begin{document}
\include{title}

%%% A page with automatically generated table of contents of the bachelor thesis

\tableofcontents

%%% Each chapter is kept in a separate file
\include{preface}
\include{chap01_debugging}
\include{chap02_tools}
\include{chap03_clang}
\include{chap04_minimization}
\include{chap05_implementation}
\include{chap06_evaluation}

\include{epilog}

%%% Bibliography
\include{bibliography}

%%% Figures used in the thesis (consider if this is needed)
\listoffigures

%%% Tables used in the thesis (consider if this is needed)
%%% In mathematical theses, it could be better to move the list of tables to the beginning of the thesis.
\listoftables

%%% Abbreviations used in the thesis, if any, including their explanation
%%% In mathematical theses, it could be better to move the list of abbreviations to the beginning of the thesis.
\chapwithtoc{List of Abbreviations}

%%% Attachments to the bachelor thesis, if any. Each attachment must be
%%% referred to at least once from the text of the thesis. Attachments
%%% are numbered.
%%%
%%% The printed version should preferably contain attachments, which can be
%%% read (additional tables and charts, supplementary text, examples of
%%% program output, etc.). The electronic version is more suited for attachments
%%% which will likely be used in an electronic form rather than read (program
%%% source code, data files, interactive charts, etc.). Electronic attachments
%%% should be uploaded to SIS and optionally also included in the thesis on a~CD/DVD.
%%% Allowed file formats are specified in provision of the rector no. 72/2017.
\appendix
\chapter{Attachments}

\section{Content of the attachment}

\section{User Documentation}

\subsection{System requirements}

The target system has to build AutoPIE, LLVM, Clang, and LLDB as well. 
Building the LLVM project utilizes a large number of system resources.  
In order to build the project correctly, the system must meet the following 
requirements:
\begin{itemize}
  \item The system must have at least 8 GB of memory.
  \item The system must have an x86-based CPU.
  \item The system should have at least 5 GB of free disk space and 
  optionally up to 40 GB of disk space for the debug build.
  \item The system must run a Linux distribution supported by LLVM 11.0.0.
\end{itemize}

Any mainstream Linux distributions released in the year 2020 and later are 
supported, provided they can run the tools specified in the following 
section. 
This list includes, for example, Manjaro 21.0, Arch Linux 2020.06.01, and 
Ubuntu 20.04.

\subsection{Prerequisites}

In order to build and launch AutoPIE, one must first install all underlying 
tools, libraries, and frameworks. 
The following list contains all tools and utilities that are required to 
build and run the project.

\begin{itemize}
  \item python2
  \item python3
  \item python-dev
  \item libedit-dev
  \item cmake
  \item ninja-build
  \item make
  \item gcc
  \item zlib
  \item coreutils
  \item graphviz
  \item docker
  \item swig
\end{itemize}

Additionally, the user must have the following packages available in their 
Python interpreter:

\begin{itemize}
  \item docker
  \item argparse
  \item shutil
  \item pathlib
\end{itemize}

Once these requirements are met, the user can proceed to build LLVM, Clang, 
and LLDB. 
The building process is lengthy, complex, and tedious. 
Therefore, we have created a script that automizes the process. 
The build can be launched by following the described steps.

\begin{enumerate}
  \item Navigate to the *autopie* directory.
  \item Use *chmod +x ./buildLLVM.sh* to give the script required permissions.
  \item Run the script as root using *sudo ./buildLLVM.sh*.
\end{enumerate}

The build script performs the following steps:

\begin{enumerate}
  \item It downloads the required version of the LLVM from the official GitHub repository. The specific version for this project is 11.0.0.
  \item It extracts the downloaded archive into a temporary directory.
  \item It creates a build subdirectory in the temporary path and navigates to it.
  \item It executes the CMake command, which prepares the build configuration for the required projects. Notably, the Clang and LLVM projects are configured in x86 Release mode with libraries and scripting support.
  \item It launches the Ninja tool, which builds the LLVM project. It then installs the necessary headers and libraries into system paths.
  \item It exports the linker library path, which now contains */usr/local/lib/*. This export expires once the current shell is terminated.
\end{enumerate}

If successful, the user can now use LLVM libraries when linking C++ projects.

\subsection{Building AutoPIE}

The project consists of several C++ binaries. 
These binaries can be built using makefiles in their respective directories. 
The \icode{autopie} directory also contains a \icode{Makefile} that builds 
all the projects. 
Once built, the binaries can be found in the following directories:
\icode{NaiveReduction} is available under 
\icode{autopie\-/NaiveReduction\-/build\-/bin\-/NaiveReduction}.
\icode{DeltaReduction} can be found under 
\icode{autopie\-/DeltaReduction\-/build\-/bin\-/DeltaReduction}.
The helper utilities \icode{VariableExtractor} and \icode{SliceExtractor} can 
be found in 
\icode{autopie\-/VariableExtractor\-/build\-/bin\-/VariableExtractor} 
and \icode{autopie\-/SliceExtractor\-/build\-/bin\-/SliceExtractor} 
respectivelly.

The slicing-based approach does not need to be built since it is implemented 
in Python. 
However, it utilizes all four mentioned C++ projects. 
Those must be present in order for the Python script to work correctly.

\subsection{Running AutoPIE}

The user can execute the three approaches as follows:

\begin{itemize}
  \item The naive approach can be launched by executing 
  the \icode{NaiveReduction} program built from the earlier steps.
  \item The minimizing Delta debugging algorithm can be launched by 
  executing the \icode{DeltaReduction} program built from the earlier steps.
  \item The slicing-based approach can be launched by running 
  \icode{python3 autopie/Scripts/SlicingReduction.py <args>}, having built 
  all other projects from the earlier steps.
\end{itemize}

Each project's required and supported arguments can be viewed using 
the \icode{--help} option available for each program and script.

The user can run the evaluation dataset by navigating to a subdirectory of 
an approach and launching \icode{evaluate.sh}. 
For example: \icode{cd autopie/NaiveReduction \&\& make \&\& ./evaluate.sh}.

\openright
\end{document}
